@model List<InsignisIllustrationGenerator.Models.IllustrationListViewModel>

<div class="row">
    <div class="col-lg-12 col-sm-12">
        <div class="deposits-table">
            <p class="gray-light-small right">Please click on a row to view Illustration detail</p>
            <table id="illustrationListTable"class="table table-striped table-bordered table-responsive-sm">
                <thead class="thead-dark">
                    <tr class="d-flex">
                        <th class="col-2">Advisor Name</th>
                        <th class="col-2">Client Name</th>
                        <th class="col-2">Company Name</th>
                        <th class="col-3">Illustration Unique Reference</th>
                        <th class="col-2">Generation Date</th>
                        <th class="col-1">Status</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model)
                    {
                        
                    
                        <tr class="d-flex" id="bankDetailRow">
                            <td class="col-2">
                                @Html.DisplayFor(modelItem => item.AdviserName)
                            </td>
                            <td class="col-2">
                                @Html.DisplayFor(modelItem => item.ClientName)
                            </td>
                            <td class="col-2">
                                @Html.DisplayFor(modelItem => item.CompanyName)
                            </td>
                            <td class="col-3">
                                @Html.DisplayFor(modelItem => item.IllustrationUniqueReference)
                                @Html.HiddenFor(modelItem => item.IllustrationUniqueReference)
                            </td>
                            <td class="col-2">
                                @Html.DisplayFor(modelItem => item.GenerateDate)
                            </td>
                            <td class="col-1">
                                @Html.DisplayFor(modelItem => item.Status)
                            </td>
                        </tr>
                    
                    }
                </tbody>
            </table>
        </div>
        <div class="clear"></div>
    </div>
</div>

<script>


    $(document).ready(function () {
        $(document).on("click", "#bankDetailRow", function () {
            var illustrationUniqueReference = $(event.target).closest('tr').find('#item_IllustrationUniqueReference').val();
            debugger;
            window.location = "/SuperUser/GetIllustration?uniqueReferenceId=" + illustrationUniqueReference; 
        });






        $(document).on("click", "#btnSearch", function () {
                var formData = $("#myform").serialize();

                $.ajax({
                    url: "../../SuperUser/SearchIllustration",
                    type: "POST",
                    data: {
                        AdvisorName: $("#AdvisorName").val(),
                        ClientName: $("#ClientName").val(),
                        CompanyName: $("#CompanyName").val(),
                        IllustrationUniqueReference: $("#IllustrationUniqueReference").val(),
                        IllustrationFrom: $("#IllustrationFrom").val(),
                        IllustrationTo: $("#IllustrationTo").val()
                    },

                    success: function (data, textStatus, jqXHR) {
                        debugger;
                        if (data.error == true) {
                            $("#validationError").text("Please specify search criteria");
                        }
                        else {
                            debugger;
                             $("#illustrationListTable tbody tr").remove();
                            for (var i = 0; i < data.length; i++) {
                                $('#illustrationListTable tr:last').after('<tr class="d-flex" id="bankDetailRow"><td class="col-2">'+data[i].adviserName+'</td><td class="col-2">'+data[i].clientName+'</td><td class="col-2">'+data[i].companyName+'</td><td class="col-3">'+data[i].illustrationUniqueReference+ '<input type="hidden" id="item_IllustrationUniqueReference" value="'+data[i].illustrationUniqueReference+'"/></td><td class="col-2">'+data[i].generateDate+'</td><td class="col-1">'+data[i].status+'</td></tr>');
                            }

                        }

                    },
                    error: function (jqXHR, textStatus, errorThrown) {

                    }
                });
            });




    });
</script>